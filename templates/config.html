<!DOCTYPE html>
<html>
<head>
    <title>{{ translations.dashboard_title }} - {{ translations.settings }}</title>
    <link rel="icon" type="image/png" href="static/favicon.png">
    <link rel="stylesheet" href="static/css/config.css">
    <script src="static/socket.io.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <!-- Desktop Navigation Buttons (left side) -->
    <div class="desktop-nav-buttons">
        <button id="desktop-back-button" class="nav-button">
            <svg xmlns="http://www.w3.org/2000/svg" height="18px" viewBox="0 -960 960 960" width="18px" fill="white"><path d="m344.09-427 211.56 211.57L480-140.78 140.78-480 480-819.22l75.65 74.65L344.09-533h475.13v106H344.09Z"/></svg>
        </button>
        <button id="desktop-save-button" class="nav-button">
            <svg xmlns="http://www.w3.org/2000/svg" height="18px" viewBox="0 -960 960 960" width="18px" fill="white"><path d="M859.22-687.91v481.13q0 44.3-30.85 75.15-30.85 30.85-75.15 30.85H206.78q-44.3 0-75.15-30.85-30.85-30.85-30.85-75.15v-546.44q0-44.3 30.85-75.15 30.85-30.85 75.15-30.85h481.13l171.31 171.31Zm-106 44.74L643.17-753.22H206.78v546.44h546.44v-436.39ZM480-246.78q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35ZM246.78-553.22h360v-160h-360v160Zm-40-89.95v436.39-546.44 110.05Z"/></svg>
            Save
        </button>
        <button id="desktop-logout-button" class="nav-button">
            <svg xmlns="http://www.w3.org/2000/svg" height="18px" viewBox="0 -960 960 960" width="18px" fill="white"><path d="M206.78-100.78q-44.3 0-75.15-30.85-30.85-30.85-30.85-75.15v-546.44q0-44.3 30.85-75.15 30.85-30.85 75.15-30.85h277.74v106H206.78v546.44h277.74v106H206.78Zm425.87-152.09L559-328.39 657.61-427H355.48v-106h302.13L559-631.61l73.65-75.52L859.22-480 632.65-252.87Z"/></svg>
            Exit
        </button>
    </div>
    
    <!-- Mobile Navigation Buttons (bottom) -->
    <div class="mobile-nav-buttons">
        <button id="mobile-back-button" class="mobile-nav-button">
            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="white"><path d="m344.09-427 211.56 211.57L480-140.78 140.78-480 480-819.22l75.65 74.65L344.09-533h475.13v106H344.09Z"/></svg>
        </button>
        <button id="mobile-save-button" class="mobile-nav-button">
            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="white"><path d="M859.22-687.91v481.13q0 44.3-30.85 75.15-30.85 30.85-75.15 30.85H206.78q-44.3 0-75.15-30.85-30.85-30.85-30.85-75.15v-546.44q0-44.3 30.85-75.15 30.85-30.85 75.15-30.85h481.13l171.31 171.31Zm-106 44.74L643.17-753.22H206.78v546.44h546.44v-436.39ZM480-246.78q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35ZM246.78-553.22h360v-160h-360v160Zm-40-89.95v436.39-546.44 110.05Z"/></svg>
        </button>
        <button id="mobile-logout-button" class="mobile-nav-button">
            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="white"><path d="M206.78-100.78q-44.3 0-75.15-30.85-30.85-30.85-30.85-75.15v-546.44q0-44.3 30.85-75.15 30.85-30.85 75.15-30.85h277.74v106H206.78v546.44h277.74v106H206.78Zm425.87-152.09L559-328.39 657.61-427H355.48v-106h302.13L559-631.61l73.65-75.52L859.22-480 632.65-252.87Z"/></svg>
        </button>
    </div>
    
    <div class="container">
        <div class="header">
            <h1>‚öôÔ∏è {{ translations.settings }}</h1>
            <p>Configure your Bitcoin dashboard</p>
        </div>
        
        <div id="config-container">
            <!-- Configuration sections will be loaded here -->
        </div>
        
        <div class="config-section" style="margin-top: 25px;">
            <div class="section-title">
                üñºÔ∏è {{ translations.meme_management }}
            </div>
            
            <div class="form-group">
                <label class="form-label">{{ translations.upload_new_meme }}</label>
                <div class="upload-area" id="upload-area">
                    <input type="file" id="file-input" accept="image/*" style="display: none;">
                    <div class="upload-placeholder">
                        <div style="font-size: 2rem; margin-bottom: 10px;">üì∑</div>
                        <p>{{ translations.upload_placeholder }}</p>
                        <p style="font-size: 0.8rem; color: #667eea;">{{ translations.upload_formats }}</p>
                    </div>
                </div>
                <div id="upload-progress" style="display: none; margin-top: 10px;">
                    <div style="background: #f0f0f0; border-radius: 10px; overflow: hidden;">
                        <div id="progress-bar" style="height: 8px; background: #667eea; width: 0%; transition: width 0.3s;"></div>
                    </div>
                    <p id="upload-status" style="margin-top: 5px; font-size: 0.9rem;"></p>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">{{ translations.current_memes }}</label>
                <div id="memes-list" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; margin-top: 10px;">
                    <!-- Memes will be loaded here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Language Change Confirmation Modal -->
    <div id="language-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>{{ translations.language }} {{ translations.settings }}</h3>
            <p>Changing the language will save your current settings and refresh the page. Continue?</p>
            <div class="modal-buttons">
                <button id="confirm-language-change" class="save-button">{{ translations.save_configuration }}</button>
                <button id="cancel-language-change" class="cancel-button">{{ translations.cancel }}</button>
            </div>
        </div>
    </div>
    
    <!-- Delete Meme Confirmation Modal -->
    <div id="delete-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>{{ translations.delete_confirmation_title }}</h3>
            <p>{{ translations.delete_confirmation_message }}</p>
            <div class="modal-buttons">
                <button id="confirm-delete" class="save-button">{{ translations.confirm_delete }}</button>
                <button id="cancel-delete" class="cancel-button">{{ translations.cancel }}</button>
            </div>
        </div>
    </div>
    
    <!-- Meme Inspection Modal -->
    <div id="meme-modal" class="modal" style="display: none;">
        <div class="modal-content meme-modal-content">
            <div class="modal-header">
                <h3 id="meme-modal-title">Meme Preview</h3>
                <button class="modal-close" onclick="closeMemeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="meme-preview-container">
                    <img id="meme-modal-image" src="" alt="Meme Preview" />
                </div>
                <div class="meme-info">
                    <div class="meme-info-row">
                        <strong>Filename:</strong> <span id="meme-modal-filename"></span>
                    </div>
                    <div class="meme-info-row">
                        <strong>Dimensions:</strong> <span id="meme-modal-dimensions">Loading...</span>
                    </div>
                    <div class="meme-info-row">
                        <strong>File Size:</strong> <span id="meme-modal-filesize">Loading...</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-button" onclick="downloadMemeFromModal()">‚¨áÔ∏è {{ translations.download_meme }}</button>
                <button class="action-button delete" onclick="deleteMemeFromModal()">üóëÔ∏è {{ translations.delete_meme }}</button>
                <button class="cancel-button" onclick="closeMemeModal()">{{ translations.cancel }}</button>
            </div>
        </div>
    </div>
    
    <div id="notification" class="notification"></div>
    
    <script>
        // Device detection for adaptive sizing
        function detectDevice() {
            const isTouchDevice = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
            const isHighDPI = window.devicePixelRatio >= 2;
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            // Add device classes to body for enhanced CSS targeting
            document.body.classList.add(isTouchDevice ? 'touch-device' : 'no-touch');
            document.body.classList.add(isHighDPI ? 'high-dpi' : 'standard-dpi');
            document.body.classList.add(isMobile ? 'mobile-device' : 'desktop-device');
            
            console.log('Device detected:', { isTouchDevice, isHighDPI, isMobile });
        }
        
        // Run device detection on load
        detectDevice();
        
        // Pass translations to JavaScript
        window.translations = {
            configuration_saved: "{{ translations.configuration_saved }}",
            upload_successful: "{{ translations.upload_successful }}",
            upload_failed: "{{ translations.upload_failed }}",
            download_failed: "{{ translations.download_failed }}",
            meme_deleted_successfully: "{{ translations.meme_deleted_successfully }}",
            meme_delete_failed: "{{ translations.meme_delete_failed }}",
            no_memes_uploaded: "{{ translations.no_memes_uploaded }}",
            download_meme: "{{ translations.download_meme }}",
            delete_meme: "{{ translations.delete_meme }}",
            enabled: "{{ translations.enabled }}",
            disabled: "{{ translations.disabled }}"
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="static/js/session-manager.js"></script>
    <script src="static/js/config.js"></script>
</body>
</html>
